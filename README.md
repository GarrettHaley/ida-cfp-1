# IDA-CFP: IDA Free C99 File Parser
IDA-CFP is a two part project designed to process C99-standard files and partially automate aspects of reverse engineering. Several similar [projects](https://github.com/onethawt/idaplugins-list) have been created in years past for the IDA Pro platform utilizing IDAPython's available API.

This project serves both as an exercise in learning what Python 3.7 has to offer as well as exploring the available interface of IDA Free. It is by no means a final work and will continue to be improved upon as time allows.

Standard pylint and Pep8 standards were strictly followed throughout the project as well as ReadTheDocs/pydocstrings for the autogenerated documentation.

## Getting Started
If you'd like to pull down the latest version of the dev codebase:

```
git clone https://github.com/yafty/ida-cfp.git
```

Or instead grab one of the releases located [here](https://github.com/yafty/ida-cfp/releases).

## Dependencies and Prerequisites
To function properly on your system the following packages, software, and configuration are required. Installation instructions for Ubuntu 16.04 LTS, Mac OSX High Sierra, and Windows 10 to follow.

* [Clang](https://releases.llvm.org/download.html) v7.0.1
* [Python](https://www.python.org/downloads/release/python-370/) v3.7
* [Pycparser](https://github.com/eliben/pycparser/releases/tag/release_v2.19) v2.19
* [IDA Free](https://www.hex-rays.com/products/ida/support/download_freeware.shtml) v7.0

NOTE: The pycparser package strictly supports only [C99](https://en.wikipedia.org/wiki/C99) standard code, no exceptions.

#### Linux (Ubuntu 16.04 or newer)
For the 7.0 release of clang you can follow the command line instructions below or check out this link [here](https://apt.llvm.org/).

```
sudo apt-get install clang-7 lldb-7 lld-7

sudo apt-get update
sudo apt-get upgrade

python3 --version
sudo apt-get install python3.7

pip --version
python -m ensurepip --default-pip

pip install pycparser
```

To download and install IDA Free, head to the hex-rays site linked in the previous section or follow their command line tutorials located [here](https://www.hex-rays.com/products/ida/support/flexlm/install_linux.shtml).

#### Mac OSX High Sierra
Homebrew is a requirement for this tutorial, please download it [here](https://brew.sh/) or follow the CLI instructions below:

```
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

brew install llvm
clang --help

brew install python3
python3 --version

pip --version
python3 -m ensurepip --default-pip

python3 -m pip install pycparser
```

Don't forget to add clang to your PATH environment variable as well. Download and install [IDA Free](https://www.hex-rays.com/products/ida/support/download_freeware.shtml) using their site.

#### Windows 10
[Chocolatey](https://chocolatey.org/), a Windows-based package manager is required for the following build instructions.

```
choco install llvm
choco upgrade llvm

choco install python3 --pre
py -V

py -m ensurepip --default-pip
py -m pip install pycparser

choco install git
```

You may also need to update your system environment variables. [IDA Free](https://www.hex-rays.com/products/ida/support/download_freeware.shtml) can be downloaded from the same link.

##
If installation of the main modules under the `pkg/` directory is preferable, the following can be run:

```
python3 setup.py install
```

Super-user permissions may be required.

## Deployment and Use
To utilize the full functionality of IDA-CFP pull down a copy to your working directory, desktop, or elsewhere. Using some of the examples provided earlier in the guide or by running `python run.py -h` (make sure `python` runs Python 3+) to see help and usage instructions, parse some of your own C99 files.

Note: Make sure you run the Python script from within the main project directory as it uses `pwd` to locate where to drop the `bundle.json` file. Running the script from other working directories can cause undefined behavior.

After the Python script has finished execution the "bundle", a JSON-formatted file, will be dropped to disk under the `out/` directory. Its format will be similar to the following:

```
{
	"unique string 1": "function_name1",
	"unique string 2": "function_name2",
	"unique string 3": "function_name3"
}
```

The bundle can also be edited or updated before the IDC script is run to correct for errors or omissions.

The IDC script is executed from within IDA Free itself and in order to be successful, it requires a binary already loaded/disassembled into IDA's database. Select the IDC script under `File->Script File...`. Once execution has started, another file selection dialog will open at which point the JSON bundle should be selected. Assuming proper JSON formatting of the `string: function name` the IDC script will then exhaustively search the target file by examining each effective address (EA). Changes to any function names as per the mapping are displayed in the GUI.

## Contributing
This project follows no official contributing guidelines beyond those shared by the general reverse engineering community. If you would like to make an addition to the codebase please make a pull request and we'll get to it as soon as possible.

## License
The code and associated documentation is licensed under the MIT Open Source License.

## Acknowledgments
Inspiration for this project came in large part from [Gbps](https://github.com/Gbps).
